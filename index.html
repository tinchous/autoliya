<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoService - Kiosco, Rotisería y Almacén</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #e74c3c;
            --secondary: #2c3e50;
            --accent: #f39c12;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --info: #17a2b8;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #fff;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        header {
            background: white;
            box-shadow: var(--shadow);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--secondary);
        }

        .logo span {
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .mobile-menu {
            display: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 8rem 0 4rem;
            text-align: center;
            margin-top: 60px;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto 2rem;
        }

        .btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: var(--transition);
            cursor: pointer;
        }

        .btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-secondary:hover {
            background: #1c2833;
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        /* Services */
        .services {
            padding: 5rem 0;
            background: var(--light);
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title h2 {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 1rem;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .service-card {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .service-card:hover {
            transform: translateY(-5px);
        }

        .service-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .service-card h3 {
            color: var(--secondary);
            margin-bottom: 1rem;
        }

        /* Products */
        .products {
            padding: 5rem 0;
        }

        .category-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-img {
            height: 200px;
            background-size: cover;
            background-position: center;
        }

        .product-content {
            padding: 1.5rem;
        }

        .product-content h3 {
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }

        .product-price {
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            justify-content: center;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-display {
            margin: 0 10px;
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        .add-to-cart {
            width: 100%;
            padding: 10px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
        }

        .add-to-cart:hover {
            background: #e67e22;
        }

        /* Carrito de Compras */
        .cart-icon {
            position: relative;
            cursor: pointer;
        }

        .cart-count {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: var(--transition);
            z-index: 1001;
            padding: 2rem;
            overflow-y: auto;
        }

        .cart-sidebar.active {
            right: 0;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .close-cart {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .cart-items {
            margin-bottom: 2rem;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }

        .cart-item-info h4 {
            margin-bottom: 0.5rem;
        }

        .cart-item-price {
            color: var(--primary);
            font-weight: bold;
        }

        .cart-item-quantity {
            display: flex;
            align-items: center;
        }

        .cart-item-quantity button {
            width: 25px;
            height: 25px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }

        .cart-item-quantity span {
            margin: 0 10px;
        }

        .remove-item {
            color: var(--primary);
            background: none;
            border: none;
            cursor: pointer;
        }

        .cart-total {
            text-align: center;
            margin-bottom: 2rem;
        }

        .checkout-btn {
            width: 100%;
            padding: 12px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .checkout-btn:hover {
            background: #218838;
        }

        /* Overlay para el carrito */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        /* Modal de Pedido */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1002;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--secondary);
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .btn-block {
            width: 100%;
        }

        /* Modal de Login/Registro */
        .auth-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #ddd;
        }

        .auth-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .auth-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        /* Dashboard del Cliente */
        .dashboard-section {
            display: none;
            margin-bottom: 2rem;
        }

        .dashboard-section.active {
            display: block;
        }

        .dashboard-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #ddd;
        }

        .dashboard-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .dashboard-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }

        .order-item {
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 1rem;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .order-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-confirmed {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status-preparing {
            background: #ffeaa7;
            color: #856404;
        }

        .status-delivered {
            background: #d4edda;
            color: #155724;
        }

        .status-cancelled {
            background: #f8d7da;
            color: #721c24;
        }

        /* WhatsApp Order Preview */
        .whatsapp-preview {
            background: #f0f0f0;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }

        .product-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background: white;
            border-radius: 4px;
        }

        .product-checkbox input {
            margin-right: 0.5rem;
        }

        .product-checked {
            text-decoration: line-through;
            opacity: 0.6;
        }

        /* Panel Administrativo */
        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 2000;
            overflow-y: auto;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-header {
            background: var(--secondary);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #ddd;
            flex-wrap: wrap;
        }

        .admin-tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .admin-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }

        .admin-section {
            display: none;
            padding: 2rem;
        }

        .admin-section.active {
            display: block;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        .admin-table th,
        .admin-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .admin-table th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .admin-actions {
            display: flex;
            gap: 0.5rem;
        }

        .admin-form {
            max-width: 600px;
            margin: 0 auto;
        }

        .admin-form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--secondary);
            font-weight: 500;
        }

        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        /* Contact */
        .contact {
            padding: 5rem 0;
            background: var(--light);
        }

        .contact-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        .contact-info h2 {
            color: var(--secondary);
            margin-bottom: 1.5rem;
        }

        .contact-details {
            margin-bottom: 2rem;
        }

        .contact-item {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .contact-item i {
            color: var(--primary);
            margin-right: 1rem;
            width: 20px;
        }

        .contact-form {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .map-container {
            margin-top: 1rem;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .map-container iframe {
            width: 100%;
            height: 200px;
            border: none;
        }

        /* Footer */
        footer {
            background: var(--secondary);
            color: white;
            padding: 3rem 0 1rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-column h3 {
            color: var(--primary);
            margin-bottom: 1.5rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.8rem;
        }

        .footer-links a {
            color: #ccc;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: white;
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-links a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            color: white;
            text-decoration: none;
            transition: var(--transition);
        }

        .social-links a:hover {
            background: var(--primary);
        }

        .copyright {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #ccc;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .mobile-menu {
                display: block;
            }

            .hero h1 {
                font-size: 2.2rem;
            }

            .contact-container {
                grid-template-columns: 1fr;
            }

            .category-tabs {
                flex-direction: column;
                align-items: center;
            }

            .tab {
                width: 100%;
                max-width: 300px;
                text-align: center;
            }

            .cart-sidebar {
                width: 100%;
                right: -100%;
            }

            .admin-form-grid {
                grid-template-columns: 1fr;
            }

            .admin-tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container nav-container">
            <div class="logo">Auto<span>Service</span></div>
            <div class="mobile-menu">
                <i class="fas fa-bars"></i>
            </div>
            <ul class="nav-links">
                <li><a href="#inicio">Inicio</a></li>
                <li><a href="#servicios">Servicios</a></li>
                <li><a href="#productos">Productos</a></li>
                <li><a href="#contacto">Contacto</a></li>
                <li>
                    <div class="cart-icon">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count">0</span>
                    </div>
                </li>
                <li><a href="#" id="accountBtn">Ingresar</a></li>
                <li><a href="#" id="adminBtn" style="display: none;">Admin</a></li>
            </ul>
        </div>
    </header>

    <!-- Resto del contenido del sitio web (Hero, Services, Products, Contact, Footer) -->
    <!-- ... -->

    <!-- Panel Administrativo -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h2>Panel Administrativo - AutoService</h2>
            <button id="closeAdminPanel" class="btn btn-secondary">Cerrar Panel</button>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" data-tab="dashboard">Dashboard</button>
            <button class="admin-tab" data-tab="products">Productos</button>
            <button class="admin-tab" data-tab="categories">Categorías</button>
            <button class="admin-tab" data-tab="orders">Pedidos</button>
            <button class="admin-tab" data-tab="users">Usuarios</button>
            <button class="admin-tab" data-tab="reports">Reportes</button>
        </div>

        <!-- Dashboard -->
        <div id="dashboardSection" class="admin-section active">
            <h3>Dashboard General</h3>
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalOrdersCount">0</div>
                    <div class="stat-label">Total Pedidos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalRevenue">$0</div>
                    <div class="stat-label">Ingresos Totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgOrderValue">$0</div>
                    <div class="stat-label">Ticket Promedio</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="pendingOrders">0</div>
                    <div class="stat-label">Pedidos Pendientes</div>
                </div>
            </div>

            <div class="chart-container">
                <h4>Ventas por Día (Últimos 7 días)</h4>
                <canvas id="salesChart" width="400" height="200"></canvas>
            </div>

            <div class="chart-container">
                <h4>Productos Más Vendidos</h4>
                <canvas id="productsChart" width="400" height="200"></canvas>
            </div>
        </div>

        <!-- Sección de Productos -->
        <div id="productsSection" class="admin-section">
            <h3>Gestión de Productos</h3>
            <button id="addProductBtn" class="btn">Agregar Producto</button>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Categoría</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="productsTable">
                    <!-- Los productos se cargarán dinámicamente -->
                </tbody>
            </table>
        </div>

        <!-- Sección de Categorías -->
        <div id="categoriesSection" class="admin-section">
            <h3>Gestión de Categorías</h3>
            <button id="addCategoryBtn" class="btn">Agregar Categoría</button>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Descripción</th>
                        <th>Productos</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="categoriesTable">
                    <!-- Las categorías se cargarán dinámicamente -->
                </tbody>
            </table>
        </div>

        <!-- Sección de Pedidos -->
        <div id="ordersSectionAdmin" class="admin-section">
            <h3>Gestión de Pedidos</h3>
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-value" id="ordersPending">0</div>
                    <div class="stat-label">Pendientes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="ordersConfirmed">0</div>
                    <div class="stat-label">Confirmados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="ordersPreparing">0</div>
                    <div class="stat-label">En Preparación</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="ordersDelivered">0</div>
                    <div class="stat-label">Entregados</div>
                </div>
            </div>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Número</th>
                        <th>Cliente</th>
                        <th>Total</th>
                        <th>Estado</th>
                        <th>Fecha</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="ordersTableAdmin">
                    <!-- Los pedidos se cargarán dinámicamente -->
                </tbody>
            </table>
        </div>

        <!-- Sección de Usuarios -->
        <div id="usersSection" class="admin-section">
            <h3>Gestión de Usuarios</h3>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Email</th>
                        <th>Teléfono</th>
                        <th>Pedidos</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="usersTable">
                    <!-- Los usuarios se cargarán dinámicamente -->
                </tbody>
            </table>
        </div>

        <!-- Sección de Reportes -->
        <div id="reportsSection" class="admin-section">
            <h3>Reportes de Ventas</h3>
            <div class="form-group">
                <label for="reportPeriod">Período</label>
                <select id="reportPeriod" class="form-control">
                    <option value="7">Últimos 7 días</option>
                    <option value="30">Últimos 30 días</option>
                    <option value="90">Últimos 3 meses</option>
                    <option value="365">Último año</option>
                    <option value="custom">Personalizado</option>
                </select>
            </div>

            <div id="customDateRange" style="display: none;">
                <div class="admin-form-grid">
                    <div class="form-group">
                        <label for="reportDateFrom">Desde</label>
                        <input type="date" id="reportDateFrom" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="reportDateTo">Hasta</label>
                        <input type="date" id="reportDateTo" class="form-control">
                    </div>
                </div>
            </div>

            <button id="generateReportBtn" class="btn btn-block">Generar Reporte</button>

            <div class="admin-stats" id="reportStats">
                <!-- Las estadísticas del reporte se cargarán aquí -->
            </div>

            <div class="chart-container">
                <h4>Ventas por Canal</h4>
                <canvas id="channelChart" width="400" height="200"></canvas>
            </div>

            <div class="chart-container">
                <h4>Evolución de Ventas</h4>
                <canvas id="trendChart" width="400" height="200"></canvas>
            </div>

            <div class="chart-container">
                <h4>Distribución por Categorías</h4>
                <canvas id="categoryChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>

    <!-- Modal para Agregar/Editar Producto -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="productModalTitle">Agregar Producto</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="productForm">
                <input type="hidden" id="productId">
                <div class="admin-form-grid">
                    <div class="form-group">
                        <label for="productName">Nombre</label>
                        <input type="text" id="productName" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="productCategory">Categoría</label>
                        <select id="productCategory" class="form-control" required>
                            <!-- Las categorías se cargarán dinámicamente -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="productPrice">Precio</label>
                        <input type="number" id="productPrice" class="form-control" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="productStock">Stock</label>
                        <input type="number" id="productStock" class="form-control" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="productDescription">Descripción</label>
                    <textarea id="productDescription" class="form-control"></textarea>
                </div>
                <div class="form-group">
                    <label for="productImage">URL de la Imagen</label>
                    <input type="text" id="productImage" class="form-control">
                </div>
                <div class="form-group">
                    <label for="productStatus">Estado</label>
                    <select id="productStatus" class="form-control">
                        <option value="active">Activo</option>
                        <option value="inactive">Inactivo</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-block">Guardar Producto</button>
            </form>
        </div>
    </div>

    <!-- Modal para Agregar/Editar Categoría -->
    <div class="modal" id="categoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="categoryModalTitle">Agregar Categoría</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="categoryForm">
                <input type="hidden" id="categoryId">
                <div class="form-group">
                    <label for="categoryName">Nombre</label>
                    <input type="text" id="categoryName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="categoryDescription">Descripción</label>
                    <textarea id="categoryDescription" class="form-control"></textarea>
                </div>
                <div class="form-group">
                    <label for="categoryStatus">Estado</label>
                    <select id="categoryStatus" class="form-control">
                        <option value="active">Activa</option>
                        <option value="inactive">Inactiva</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-block">Guardar Categoría</button>
            </form>
        </div>
    </div>

    <!-- Modal para Detalles de Pedido -->
    <div class="modal" id="orderDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Detalles del Pedido <span id="orderDetailsNumber"></span></h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="orderDetailsContent">
                <!-- Los detalles del pedido se cargarán aquí -->
            </div>
        </div>
    </div>

    <script>
        // Estado de la aplicación
        let cart = [];
        let currentUser = null;
        let orders = [];
        let products = [];
        let categories = [];
        let users = [];
        let isAdmin = false;

        // Charts
        let salesChart = null;
        let productsChart = null;
        let channelChart = null;
        let trendChart = null;
        let categoryChart = null;

        // Elementos del DOM
        const adminPanel = document.getElementById('adminPanel');
        const adminBtn = document.getElementById('adminBtn');
        const closeAdminPanel = document.getElementById('closeAdminPanel');
        const adminTabs = document.querySelectorAll('.admin-tab');
        const adminSections = document.querySelectorAll('.admin-section');

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar si hay un usuario logueado
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('accountBtn').textContent = 'Mi Cuenta';

                // Verificar si es admin
                if (currentUser.email === 'admin@autoservice.com') {
                    isAdmin = true;
                    adminBtn.style.display = 'block';
                }
            }

            // Cargar datos
            loadOrders();
            loadProducts();
            loadCategories();
            loadUsers();

            // Configurar event listeners del panel administrativo
            setupAdminPanel();
        });

        // Configurar el panel administrativo
        function setupAdminPanel() {
            // Abrir panel administrativo
            adminBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (isAdmin) {
                    adminPanel.classList.add('active');
                    updateDashboard();
                }
            });

            // Cerrar panel administrativo
            closeAdminPanel.addEventListener('click', () => {
                adminPanel.classList.remove('active');
            });

            // Cambiar entre pestañas
            adminTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');

                    // Activar pestaña seleccionada
                    adminTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    // Mostrar sección correspondiente
                    adminSections.forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(tabName + 'Section').classList.add('active');

                    // Actualizar la sección si es necesario
                    if (tabName === 'dashboard') {
                        updateDashboard();
                    } else if (tabName === 'orders') {
                        renderAdminOrders();
                    } else if (tabName === 'products') {
                        renderAdminProducts();
                    } else if (tabName === 'categories') {
                        renderAdminCategories();
                    } else if (tabName === 'users') {
                        renderAdminUsers();
                    }
                });
            });

            // Botones de agregar
            document.getElementById('addProductBtn').addEventListener('click', () => {
                openProductModal();
            });

            document.getElementById('addCategoryBtn').addEventListener('click', () => {
                openCategoryModal();
            });

            // Formularios
            document.getElementById('productForm').addEventListener('submit', handleProductSubmit);
            document.getElementById('categoryForm').addEventListener('submit', handleCategorySubmit);

            // Reportes
            document.getElementById('reportPeriod').addEventListener('change', function() {
                document.getElementById('customDateRange').style.display =
                    this.value === 'custom' ? 'block' : 'none';
            });

            document.getElementById('generateReportBtn').addEventListener('click', generateReports);
        }

        // Cargar órdenes
        function loadOrders() {
            const savedOrders = localStorage.getItem('orders');
            if (savedOrders) {
                orders = JSON.parse(savedOrders);
            } else {
                // Datos de ejemplo
                orders = [
                    {
                        number: 'ORD100001',
                        name: 'Juan Pérez',
                        phone: '+598 99 123 456',
                        address: 'Av. Principal 123',
                        email: 'juan@example.com',
                        items: [
                            { name: 'Pollo al Spiedo', price: 1200, quantity: 1 },
                            { name: 'Gaseosas 2.25L', price: 350, quantity: 2 }
                        ],
                        subtotal: 1900,
                        shipping: 50,
                        total: 1950,
                        date: new Date().toISOString(),
                        status: 'pending'
                    },
                    {
                        number: 'ORD100002',
                        name: 'María García',
                        phone: '+598 98 654 321',
                        address: 'Calle Secundaria 456',
                        email: 'maria@example.com',
                        items: [
                            { name: 'Empanadas', price: 180, quantity: 6 },
                            { name: 'Agua Mineral', price: 280, quantity: 1 }
                        ],
                        subtotal: 1360,
                        shipping: 50,
                        total: 1410,
                        date: new Date(Date.now() - 86400000).toISOString(),
                        status: 'confirmed'
                    }
                ];
                localStorage.setItem('orders', JSON.stringify(orders));
            }
        }

        // Cargar productos
        function loadProducts() {
            const savedProducts = localStorage.getItem('products');
            if (savedProducts) {
                products = JSON.parse(savedProducts);
            } else {
                // Datos de ejemplo
                products = [
                    { id: 1, name: 'Pollo al Spiedo', category: '1', price: 1200, stock: 10, image: 'https://images.unsplash.com/photo-1598214886806-c87b84b7078b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', description: 'Pollo entero asado al spiedo', status: 'active' },
                    { id: 2, name: 'Empanadas', category: '1', price: 180, stock: 20, image: 'https://images.unsplash.com/photo-1563245372-f21724e3856d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', description: 'Empanadas caseras de carne', status: 'active' },
                    { id: 3, name: 'Gaseosas 2.25L', category: '2', price: 350, stock: 50, image: 'https://images.unsplash.com/photo-1622483767028-3f66f32aef97?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', description: 'Gaseosas de 2.25 litros', status: 'active' },
                    { id: 4, name: 'Agua Mineral', category: '2', price: 280, stock: 30, image: 'https://images.unsplash.com/photo-1541692641319-981cc79ee10a?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', description: 'Agua mineral sin gas', status: 'active' },
                    { id: 5, name: 'Snacks Variados', category: '3', price: 280, stock: 25, image: 'https://images.unsplash.com/photo-1623241896326-a7e685896c3a?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', description: 'Variedad de snacks', status: 'active' },
                    { id: 6, name: 'Galletitas', category: '3', price: 320, stock: 40, image: 'https://images.unsplash.com/photo-1586201375761-83865001e31c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', description: 'Galletitas surtidas', status: 'active' }
                ];
                localStorage.setItem('products', JSON.stringify(products));
            }
        }

        // Cargar categorías
        function loadCategories() {
            const savedCategories = localStorage.getItem('categories');
            if (savedCategories) {
                categories = JSON.parse(savedCategories);
            } else {
                // Datos de ejemplo
                categories = [
                    { id: 1, name: 'Rotisería', description: 'Comidas preparadas', status: 'active' },
                    { id: 2, name: 'Bebidas', description: 'Refrescos y aguas', status: 'active' },
                    { id: 3, name: 'Almacén', description: 'Productos de almacén', status: 'active' },
                    { id: 4, name: 'Panadería', description: 'Pan y facturas', status: 'active' }
                ];
                localStorage.setItem('categories', JSON.stringify(categories));
            }
        }

        // Cargar usuarios
        function loadUsers() {
            const savedUsers = localStorage.getItem('users');
            if (savedUsers) {
                users = JSON.parse(savedUsers);
            } else {
                // Datos de ejemplo
                users = [
                    { id: 1, name: 'Administrador', email: 'admin@autoservice.com', phone: '+598 92 308 828', orders: 15, isAdmin: true },
                    { id: 2, name: 'Cliente Demo', email: 'cliente@demo.com', phone: '+598 99 123 456', orders: 3, isAdmin: false }
                ];
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        // Actualizar dashboard
        function updateDashboard() {
            // Estadísticas generales
            const totalOrders = orders.length;
            const totalRevenue = orders.reduce((sum, order) => sum + order.total, 0);
            const avgOrderValue = totalOrders > 0 ? totalRevenue / totalOrders : 0;
            const pendingOrders = orders.filter(order => order.status === 'pending').length;

            document.getElementById('totalOrdersCount').textContent = totalOrders;
            document.getElementById('totalRevenue').textContent = '$' + totalRevenue.toFixed(2);
            document.getElementById('avgOrderValue').textContent = '$' + avgOrderValue.toFixed(2);
            document.getElementById('pendingOrders').textContent = pendingOrders;

            // Gráfico de ventas por día
            updateSalesChart();

            // Gráfico de productos más vendidos
            updateProductsChart();
        }

        // Actualizar gráfico de ventas
        function updateSalesChart() {
            const ctx = document.getElementById('salesChart').getContext('2d');

            // Datos de ejemplo para los últimos 7 días
            const labels = [];
            const data = [];

            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                labels.push(date.toLocaleDateString('es-ES', { weekday: 'short', day: 'numeric' }));

                // Calcular ventas para este día (simulado)
                const daySales = orders.filter(order => {
                    const orderDate = new Date(order.date);
                    return orderDate.toDateString() === date.toDateString();
                }).reduce((sum, order) => sum + order.total, 0);

                data.push(daySales);
            }

            if (salesChart) {
                salesChart.destroy();
            }

            salesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Ventas ($)',
                        data: data,
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1,
                        fill: true,
                        backgroundColor: 'rgba(75, 192, 192, 0.1)'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Ventas Diarias'
                        }
                    }
                }
            });
        }

        // Actualizar gráfico de productos
        function updateProductsChart() {
            const ctx = document.getElementById('productsChart').getContext('2d');

            // Calcular productos más vendidos
            const productSales = {};
            orders.forEach(order => {
                order.items.forEach(item => {
                    if (productSales[item.name]) {
                        productSales[item.name] += item.quantity;
                    } else {
                        productSales[item.name] = item.quantity;
                    }
                });
            });

            const sortedProducts = Object.entries(productSales)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);

            const labels = sortedProducts.map(p => p[0]);
            const data = sortedProducts.map(p => p[1]);

            if (productsChart) {
                productsChart.destroy();
            }

            productsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Unidades Vendidas',
                        data: data,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(153, 102, 255, 0.7)'
                        ],
                        borderColor: [
                            'rgb(255, 99, 132)',
                            'rgb(54, 162, 235)',
                            'rgb(255, 206, 86)',
                            'rgb(75, 192, 192)',
                            'rgb(153, 102, 255)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Productos Más Vendidos'
                        }
                    }
                }
            });
        }

        // Renderizar productos en el panel administrativo
        function renderAdminProducts() {
            const table = document.getElementById('productsTable');
            table.innerHTML = '';

            products.forEach(product => {
                const category = categories.find(c => c.id == product.category) || { name: 'Sin categoría' };

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${product.id}</td>
                    <td>${product.name}</td>
                    <td>${category.name}</td>
                    <td>$${product.price}</td>
                    <td>${product.stock}</td>
                    <td><span class="status-${product.status}">${product.status === 'active' ? 'Activo' : 'Inactivo'}</span></td>
                    <td class="admin-actions">
                        <button class="btn btn-warning" onclick="editProduct(${product.id})">Editar</button>
                        <button class="btn btn-secondary" onclick="toggleProductStatus(${product.id})">${product.status === 'active' ? 'Desactivar' : 'Activar'}</button>
                        <button class="btn" onclick="deleteProduct(${product.id})">Eliminar</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        // Renderizar categorías en el panel administrativo
        function renderAdminCategories() {
            const table = document.getElementById('categoriesTable');
            table.innerHTML = '';

            categories.forEach(category => {
                const productCount = products.filter(p => p.category == category.id).length;

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${category.id}</td>
                    <td>${category.name}</td>
                    <td>${category.description}</td>
                    <td>${productCount}</td>
                    <td class="admin-actions">
                        <button class="btn btn-warning" onclick="editCategory(${category.id})">Editar</button>
                        <button class="btn btn-secondary" onclick="toggleCategoryStatus(${category.id})">${category.status === 'active' ? 'Desactivar' : 'Activar'}</button>
                        <button class="btn" onclick="deleteCategory(${category.id})">Eliminar</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        // Renderizar pedidos en el panel administrativo
        function renderAdminOrders() {
            const table = document.getElementById('ordersTableAdmin');
            table.innerHTML = '';

            // Actualizar estadísticas de pedidos
            const pending = orders.filter(o => o.status === 'pending').length;
            const confirmed = orders.filter(o => o.status === 'confirmed').length;
            const preparing = orders.filter(o => o.status === 'preparing').length;
            const delivered = orders.filter(o => o.status === 'delivered').length;

            document.getElementById('ordersPending').textContent = pending;
            document.getElementById('ordersConfirmed').textContent = confirmed;
            document.getElementById('ordersPreparing').textContent = preparing;
            document.getElementById('ordersDelivered').textContent = delivered;

            if (orders.length === 0) {
                table.innerHTML = '<tr><td colspan="6" class="text-center">No hay pedidos</td></tr>';
                return;
            }

            // Ordenar pedidos por fecha (más recientes primero)
            const sortedOrders = [...orders].sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedOrders.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.number}</td>
                    <td>${order.name}</td>
                    <td>$${order.total.toFixed(2)}</td>
                    <td>
                        <select class="form-control" onchange="updateOrderStatus('${order.number}', this.value)">
                            <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pendiente</option>
                            <option value="confirmed" ${order.status === 'confirmed' ? 'selected' : ''}>Confirmado</option>
                            <option value="preparing" ${order.status === 'preparing' ? 'selected' : ''}>En Preparación</option>
                            <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>Entregado</option>
                            <option value="cancelled" ${order.status === 'cancelled' ? 'selected' : ''}>Cancelado</option>
                        </select>
                    </td>
                    <td>${new Date(order.date).toLocaleDateString()}</td>
                    <td class="admin-actions">
                        <button class="btn" onclick="viewOrderDetails('${order.number}')">Ver Detalles</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        // Renderizar usuarios en el panel administrativo
        function renderAdminUsers() {
            const table = document.getElementById('usersTable');
            table.innerHTML = '';

            users.forEach(user => {
                const userOrders = orders.filter(order => order.email === user.email).length;

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.phone}</td>
                    <td>${userOrders}</td>
                    <td class="admin-actions">
                        <button class="btn btn-warning" onclick="editUser(${user.id})">Editar</button>
                        <button class="btn" onclick="deleteUser(${user.id})">Eliminar</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        // Abrir modal de producto
        function openProductModal(productId = null) {
            const modal = document.getElementById('productModal');
            const form = document.getElementById('productForm');
            const title = document.getElementById('productModalTitle');

            // Llenar select de categorías
            const categorySelect = document.getElementById('productCategory');
            categorySelect.innerHTML = '';
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                categorySelect.appendChild(option);
            });

            if (productId) {
                // Modo edición
                title.textContent = 'Editar Producto';
                const product = products.find(p => p.id === productId);
                if (product) {
                    document.getElementById('productId').value = product.id;
                    document.getElementById('productName').value = product.name;
                    document.getElementById('productCategory').value = product.category;
                    document.getElementById('productPrice').value = product.price;
                    document.getElementById('productStock').value = product.stock;
                    document.getElementById('productDescription').value = product.description || '';
                    document.getElementById('productImage').value = product.image || '';
                    document.getElementById('productStatus').value = product.status;
                }
            } else {
                // Modo agregar
                title.textContent = 'Agregar Producto';
                form.reset();
                document.getElementById('productId').value = '';
            }

            modal.classList.add('active');
            document.querySelector('.overlay').classList.add('active');
        }

        // Abrir modal de categoría
        function openCategoryModal(categoryId = null) {
            const modal = document.getElementById('categoryModal');
            const form = document.getElementById('categoryForm');
            const title = document.getElementById('categoryModalTitle');

            if (categoryId) {
                // Modo edición
                title.textContent = 'Editar Categoría';
                const category = categories.find(c => c.id === categoryId);
                if (category) {
                    document.getElementById('categoryId').value = category.id;
                    document.getElementById('categoryName').value = category.name;
                    document.getElementById('categoryDescription').value = category.description || '';
                    document.getElementById('categoryStatus').value = category.status;
                }
            } else {
                // Modo agregar
                title.textContent = 'Agregar Categoría';
                form.reset();
                document.getElementById('categoryId').value = '';
            }

            modal.classList.add('active');
            document.querySelector('.overlay').classList.add('active');
        }

        // Manejar envío de formulario de producto
        function handleProductSubmit(e) {
            e.preventDefault();

            const productId = document.getElementById('productId').value;
            const productData = {
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                price: parseFloat(document.getElementById('productPrice').value),
                stock: parseInt(document.getElementById('productStock').value),
                description: document.getElementById('productDescription').value,
                image: document.getElementById('productImage').value,
                status: document.getElementById('productStatus').value
            };

            if (productId) {
                // Actualizar producto existente
                const index = products.findIndex(p => p.id == productId);
                if (index !== -1) {
                    products[index] = { ...products[index], ...productData };
                }
            } else {
                // Agregar nuevo producto
                const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                products.push({
                    id: newId,
                    ...productData
                });
            }

            localStorage.setItem('products', JSON.stringify(products));
            renderAdminProducts();

            document.getElementById('productModal').classList.remove('active');
            document.querySelector('.overlay').classList.remove('active');

            alert(productId ? 'Producto actualizado correctamente' : 'Producto agregado correctamente');
        }

        // Manejar envío de formulario de categoría
        function handleCategorySubmit(e) {
            e.preventDefault();

            const categoryId = document.getElementById('categoryId').value;
            const categoryData = {
                name: document.getElementById('categoryName').value,
                description: document.getElementById('categoryDescription').value,
                status: document.getElementById('categoryStatus').value
            };

            if (categoryId) {
                // Actualizar categoría existente
                const index = categories.findIndex(c => c.id == categoryId);
                if (index !== -1) {
                    categories[index] = { ...categories[index], ...categoryData };
                }
            } else {
                // Agregar nueva categoría
                const newId = categories.length > 0 ? Math.max(...categories.map(c => c.id)) + 1 : 1;
                categories.push({
                    id: newId,
                    ...categoryData
                });
            }

            localStorage.setItem('categories', JSON.stringify(categories));
            renderAdminCategories();

            document.getElementById('categoryModal').classList.remove('active');
            document.querySelector('.overlay').classList.remove('active');

            alert(categoryId ? 'Categoría actualizada correctamente' : 'Categoría agregada correctamente');
        }

        // Funciones de administración de productos
        function editProduct(productId) {
            openProductModal(productId);
        }

        function toggleProductStatus(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                product.status = product.status === 'active' ? 'inactive' : 'active';
                localStorage.setItem('products', JSON.stringify(products));
                renderAdminProducts();
                alert(`Producto ${product.status === 'active' ? 'activado' : 'desactivado'} correctamente`);
            }
        }

        function deleteProduct(productId) {
            if (confirm('¿Estás seguro de que quieres eliminar este producto?')) {
                products = products.filter(p => p.id !== productId);
                localStorage.setItem('products', JSON.stringify(products));
                renderAdminProducts();
                alert('Producto eliminado correctamente');
            }
        }

        // Funciones de administración de categorías
        function editCategory(categoryId) {
            openCategoryModal(categoryId);
        }

        function toggleCategoryStatus(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (category) {
                category.status = category.status === 'active' ? 'inactive' : 'active';
                localStorage.setItem('categories', JSON.stringify(categories));
                renderAdminCategories();
                alert(`Categoría ${category.status === 'active' ? 'activada' : 'desactivada'} correctamente`);
            }
        }

        function deleteCategory(categoryId) {
            if (confirm('¿Estás seguro de que quieres eliminar esta categoría?')) {
                categories = categories.filter(c => c.id !== categoryId);
                localStorage.setItem('categories', JSON.stringify(categories));
                renderAdminCategories();
                alert('Categoría eliminada correctamente');
            }
        }

        // Funciones de administración de pedidos
        function updateOrderStatus(orderNumber, newStatus) {
            const order = orders.find(o => o.number === orderNumber);
            if (order) {
                order.status = newStatus;
                localStorage.setItem('orders', JSON.stringify(orders));
                renderAdminOrders();
                alert(`Estado del pedido ${orderNumber} actualizado a ${getStatusText(newStatus)}`);
            }
        }

        function viewOrderDetails(orderNumber) {
            const order = orders.find(o => o.number === orderNumber);
            if (order) {
                document.getElementById('orderDetailsNumber').textContent = order.number;

                let details = `
                    <div class="form-group">
                        <label>Cliente:</label>
                        <p>${order.name}</p>
                    </div>
                    <div class="form-group">
                        <label>Teléfono:</label>
                        <p>${order.phone}</p>
                    </div>
                    <div class="form-group">
                        <label>Dirección:</label>
                        <p>${order.address}</p>
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <p>${order.email || 'No proporcionado'}</p>
                    </div>
                    <div class="form-group">
                        <label>Fecha:</label>
                        <p>${new Date(order.date).toLocaleString()}</p>
                    </div>
                    <div class="form-group">
                        <label>Estado:</label>
                        <p><span class="status-${order.status}">${getStatusText(order.status)}</span></p>
                    </div>
                    <div class="form-group">
                        <label>Productos:</label>
                        <ul>
                `;

                order.items.forEach(item => {
                    details += `<li>${item.quantity}x ${item.name} - $${item.price}</li>`;
                });

                details += `
                        </ul>
                    </div>
                    <div class="form-group">
                        <label>Subtotal:</label>
                        <p>$${order.subtotal.toFixed(2)}</p>
                    </div>
                    <div class="form-group">
                        <label>Envío:</label>
                        <p>$${order.shipping.toFixed(2)}</p>
                    </div>
                    <div class="form-group">
                        <label>Total:</label>
                        <p><strong>$${order.total.toFixed(2)}</strong></p>
                    </div>
                `;

                document.getElementById('orderDetailsContent').innerHTML = details;
                document.getElementById('orderDetailsModal').classList.add('active');
                document.querySelector('.overlay').classList.add('active');
            }
        }

        // Funciones de administración de usuarios
        function editUser(userId) {
            const user = users.find(u => u.id === userId);
            if (user) {
                const newName = prompt('Nuevo nombre del usuario:', user.name);
                if (newName) {
                    user.name = newName;
                    localStorage.setItem('users', JSON.stringify(users));
                    renderAdminUsers();
                    alert('Usuario actualizado correctamente');
                }
            }
        }

        function deleteUser(userId) {
            if (confirm('¿Estás seguro de que quieres eliminar este usuario?')) {
                users = users.filter(u => u.id !== userId);
                localStorage.setItem('users', JSON.stringify(users));
                renderAdminUsers();
                alert('Usuario eliminado correctamente');
            }
        }

        // Generar reportes
        function generateReports() {
            const period = document.getElementById('reportPeriod').value;
            let startDate, endDate = new Date();

            if (period === 'custom') {
                startDate = new Date(document.getElementById('reportDateFrom').value);
                endDate = new Date(document.getElementById('reportDateTo').value);
            } else {
                startDate = new Date();
                startDate.setDate(startDate.getDate() - parseInt(period));
            }

            // Filtrar órdenes por período
            const filteredOrders = orders.filter(order => {
                const orderDate = new Date(order.date);
                return orderDate >= startDate && orderDate <= endDate;
            });

            // Calcular estadísticas
            const totalSales = filteredOrders.reduce((sum, order) => sum + order.total, 0);
            const totalOrders = filteredOrders.length;
            const avgOrderValue = totalOrders > 0 ? totalSales / totalOrders : 0;

            // Actualizar estadísticas del reporte
            document.getElementById('reportStats').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${totalOrders}</div>
                    <div class="stat-label">Pedidos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">$${totalSales.toFixed(2)}</div>
                    <div class="stat-label">Ventas Totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">$${avgOrderValue.toFixed(2)}</div>
                    <div class="stat-label">Ticket Promedio</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${filteredOrders.filter(o => o.status === 'delivered').length}</div>
                    <div class="stat-label">Pedidos Entregados</div>
                </div>
            `;

            // Generar gráficos de reportes
            generateChannelChart(filteredOrders);
            generateTrendChart(filteredOrders, startDate, endDate);
            generateCategoryChart(filteredOrders);
        }

        // Generar gráfico de canales de venta
        function generateChannelChart(orders) {
            const ctx = document.getElementById('channelChart').getContext('2d');

            // Simular datos de canales de venta
            const channelData = {
                'WhatsApp': orders.length * 0.7,
                'Sitio Web': orders.length * 0.2,
                'Teléfono': orders.length * 0.1
            };

            if (channelChart) {
                channelChart.destroy();
            }

            channelChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(channelData),
                    datasets: [{
                        data: Object.values(channelData),
                        backgroundColor: [
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)'
                        ],
                        borderColor: [
                            'rgb(75, 192, 192)',
                            'rgb(54, 162, 235)',
                            'rgb(255, 206, 86)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Ventas por Canal'
                        }
                    }
                }
            });
        }

        // Generar gráfico de tendencias
        function generateTrendChart(orders, startDate, endDate) {
            const ctx = document.getElementById('trendChart').getContext('2d');

            // Calcular ventas por día
            const dailySales = {};
            const currentDate = new Date(startDate);

            while (currentDate <= endDate) {
                const dateStr = currentDate.toLocaleDateString('es-ES', { day: 'numeric', month: 'short' });
                dailySales[dateStr] = 0;
                currentDate.setDate(currentDate.getDate() + 1);
            }

            orders.forEach(order => {
                const orderDate = new Date(order.date);
                const dateStr = orderDate.toLocaleDateString('es-ES', { day: 'numeric', month: 'short' });
                if (dailySales[dateStr] !== undefined) {
                    dailySales[dateStr] += order.total;
                }
            });

            if (trendChart) {
                trendChart.destroy();
            }

            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Object.keys(dailySales),
                    datasets: [{
                        label: 'Ventas Diarias ($)',
                        data: Object.values(dailySales),
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1,
                        fill: true,
                        backgroundColor: 'rgba(75, 192, 192, 0.1)'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Evolución de Ventas'
                        }
                    }
                }
            });
        }

        // Generar gráfico por categorías
        function generateCategoryChart(orders) {
            const ctx = document.getElementById('categoryChart').getContext('2d');

            // Calcular ventas por categoría
            const categorySales = {};
            orders.forEach(order => {
                order.items.forEach(item => {
                    const product = products.find(p => p.name === item.name);
                    if (product) {
                        const category = categories.find(c => c.id == product.category);
                        const categoryName = category ? category.name : 'Sin categoría';
                        const itemTotal = item.price * item.quantity;

                        if (categorySales[categoryName]) {
                            categorySales[categoryName] += itemTotal;
                        } else {
                            categorySales[categoryName] = itemTotal;
                        }
                    }
                });
            });

            if (categoryChart) {
                categoryChart.destroy();
            }

            categoryChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(categorySales),
                    datasets: [{
                        label: 'Ventas por Categoría ($)',
                        data: Object.values(categorySales),
                        backgroundColor: 'rgba(153, 102, 255, 0.7)',
                        borderColor: 'rgb(153, 102, 255)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Ventas por Categoría'
                        }
                    }
                }
            });
        }

        // Función auxiliar para obtener texto del estado
        function getStatusText(status) {
            const statusMap = {
                'pending': 'Pendiente',
                'confirmed': 'Confirmado',
                'preparing': 'En Preparación',
                'delivered': 'Entregado',
                'cancelled': 'Cancelado'
            };
            return statusMap[status] || status;
        }

        // Cerrar modales
        document.querySelectorAll('.close-modal').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                });
                document.querySelector('.overlay').classList.remove('active');
            });
        });

        document.querySelector('.overlay').addEventListener('click', function() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
            this.classList.remove('active');
        });
    </script>
</body>
</html>
